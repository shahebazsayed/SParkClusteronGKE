steps:
- name: 'gcr.io/cloud-builders/docker'
  args: ['build', '--tag=gcr.io/sparkonk8/gcloud', '-f', 'Dockerfile', '.']

# Simple sanity check: invoke the new gcloud container to confirm that it was
# built correctly.
- name: 'gcr.io/sparkonk8/gcloud'
  args: ['info']
# Invoke a command that requires auth, to check that it gets piped through
# correctly.
- name: 'gcr.io/sparkonk8/gcloud'
  args: ['-c', '|',
    gcloud config set compute/zone us-central1-f
    gcloud container clusters create spark-on-gke --machine-type n1-standard-2
    ]

images:
- 'gcr.io/sparkonk8/gcloud'
